<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Age-structured model using fishery length composition — SCA_CAL • SAMtool</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Age-structured model using fishery length composition — SCA_CAL"><meta name="description" content="A single-fleet assessment that fits to catch, indices of abundance, and fishery length compositions. See SCA for all details."><meta property="og:description" content="A single-fleet assessment that fits to catch, indices of abundance, and fishery length compositions. See SCA for all details."><meta property="og:image" content="https://samtool.openmse.com/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SAMtool</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Blue-Matter/SAMtool/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Age-structured model using fishery length composition</h1>
      <small class="dont-index">Source: <a href="https://github.com/Blue-Matter/SAMtool/blob/master/R/assess_SCA_ext.R" class="external-link"><code>R/assess_SCA_ext.R</code></a></small>
      <div class="d-none name"><code>SCA_CAL.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A single-fleet assessment that fits to catch, indices of abundance, and fishery length compositions. See <a href="SCA.html">SCA</a> for all details.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">SCA_CAL</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">Data</span>,</span>
<span>  AddInd <span class="op">=</span> <span class="st">"B"</span>,</span>
<span>  SR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BH"</span>, <span class="st">"Ricker"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  vulnerability <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"logistic"</span>, <span class="st">"dome"</span><span class="op">)</span>,</span>
<span>  catch_eq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Baranov"</span>, <span class="st">"Pope"</span><span class="op">)</span>,</span>
<span>  CAL_dist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"multinomial"</span>, <span class="st">"lognormal"</span><span class="op">)</span>,</span>
<span>  CAL_multiplier <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  rescale <span class="op">=</span> <span class="st">"mean1"</span>,</span>
<span>  max_age <span class="op">=</span> <span class="va">Data</span><span class="op">@</span><span class="va">MaxAge</span>,</span>
<span>  start <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  fix_h <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  fix_F_equilibrium <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  fix_omega <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  fix_tau <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  LWT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  early_dev <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"comp_onegen"</span>, <span class="st">"comp"</span>, <span class="st">"all"</span><span class="op">)</span>,</span>
<span>  late_dev <span class="op">=</span> <span class="st">"comp50"</span>,</span>
<span>  integrate <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  silent <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  opt_hess <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  n_restart <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">opt_hess</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>iter.max <span class="op">=</span> <span class="fl">2e+05</span>, eval.max <span class="op">=</span> <span class="fl">4e+05</span><span class="op">)</span>,</span>
<span>  inner.control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A position in the Data object (by default, equal to one for assessments).</p></dd>


<dt id="arg-data">Data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>An object of class Data</p></dd>


<dt id="arg-addind">AddInd<a class="anchor" aria-label="anchor" href="#arg-addind"></a></dt>
<dd><p>A vector of integers or character strings indicating the indices to be used in the model. Integers assign the index to
the corresponding index in Data@AddInd, "B" (or 0) represents total biomass in Data@Ind, "VB" represents vulnerable biomass in
Data@VInd, and "SSB" represents spawning stock biomass in Data@SpInd. Vulnerability to the survey is fixed in the model.</p></dd>


<dt id="arg-sr">SR<a class="anchor" aria-label="anchor" href="#arg-sr"></a></dt>
<dd><p>Stock-recruit function (either <code>"BH"</code> for Beverton-Holt, <code>"Ricker"</code>, or <code>"none"</code> for constant mean recruitment).</p></dd>


<dt id="arg-vulnerability">vulnerability<a class="anchor" aria-label="anchor" href="#arg-vulnerability"></a></dt>
<dd><p>Whether estimated vulnerability is <code>"logistic"</code> or <code>"dome"</code> (double-normal).
See details for parameterization.</p></dd>


<dt id="arg-catch-eq">catch_eq<a class="anchor" aria-label="anchor" href="#arg-catch-eq"></a></dt>
<dd><p>Whether to use the Baranov equation or Pope's approximation to calculate the predicted catch at age in the model.</p></dd>


<dt id="arg-cal-dist">CAL_dist<a class="anchor" aria-label="anchor" href="#arg-cal-dist"></a></dt>
<dd><p>Character, the statistical distribution for the likelihood of the catch-at-length.</p></dd>


<dt id="arg-cal-multiplier">CAL_multiplier<a class="anchor" aria-label="anchor" href="#arg-cal-multiplier"></a></dt>
<dd><p>Numeric for data weighting of catch-at-length matrix if <code>CAL_hist = "multinomial"</code>. A value smaller than one
rescales annual sample sizes to this fraction of the original sample size. Values greater than one generates a cap of the annual sample
size to this value.</p></dd>


<dt id="arg-rescale">rescale<a class="anchor" aria-label="anchor" href="#arg-rescale"></a></dt>
<dd><p>A multiplicative factor that rescales the catch in the assessment model, which
can improve convergence. By default, <code>"mean1"</code> scales the catch so that time series mean is 1, otherwise a numeric.
Output is re-converted back to original units.</p></dd>


<dt id="arg-max-age">max_age<a class="anchor" aria-label="anchor" href="#arg-max-age"></a></dt>
<dd><p>Integer, the maximum age (plus-group) in the model.</p></dd>


<dt id="arg-start">start<a class="anchor" aria-label="anchor" href="#arg-start"></a></dt>
<dd><p>Optional list of starting values. Entries can be expressions that are evaluated in the function. See details.</p></dd>


<dt id="arg-prior">prior<a class="anchor" aria-label="anchor" href="#arg-prior"></a></dt>
<dd><p>A named list for the parameters of any priors to be added to the model. See below.</p></dd>


<dt id="arg-fix-h">fix_h<a class="anchor" aria-label="anchor" href="#arg-fix-h"></a></dt>
<dd><p>Logical, whether to fix steepness to value in <code>Data@steep</code> in the model for <code>SCA</code>. This only affects
calculation of reference points for <code>SCA2</code>.</p></dd>


<dt id="arg-fix-f-equilibrium">fix_F_equilibrium<a class="anchor" aria-label="anchor" href="#arg-fix-f-equilibrium"></a></dt>
<dd><p>Logical, whether the equilibrium fishing mortality prior to the first year of the model
is estimated. If <code>TRUE</code>, <code>F_equilibrium</code> is fixed to value provided in <code>start</code> (if provided),
otherwise, equal to zero (assumes unfished conditions).</p></dd>


<dt id="arg-fix-omega">fix_omega<a class="anchor" aria-label="anchor" href="#arg-fix-omega"></a></dt>
<dd><p>Logical, whether the standard deviation of the catch is fixed. If <code>TRUE</code>,
omega is fixed to value provided in <code>start</code> (if provided), otherwise, value based on <code>Data@CV_Cat</code>.</p></dd>


<dt id="arg-fix-tau">fix_tau<a class="anchor" aria-label="anchor" href="#arg-fix-tau"></a></dt>
<dd><p>Logical, the standard deviation of the recruitment deviations is fixed. If <code>TRUE</code>,
tau is fixed to value provided in <code>start</code> (if provided), otherwise, value based on <code>Data@sigmaR</code>.</p></dd>


<dt id="arg-lwt">LWT<a class="anchor" aria-label="anchor" href="#arg-lwt"></a></dt>
<dd><p>A named list (Index, CAA, Catch) of likelihood weights for the data components. For the index, a vector of length survey. For
CAL and Catch, a single value.</p></dd>


<dt id="arg-early-dev">early_dev<a class="anchor" aria-label="anchor" href="#arg-early-dev"></a></dt>
<dd><p>Numeric or character string describing the years for which recruitment deviations are estimated in <code>SCA</code>. By default,
equal to <code>"comp_onegen"</code>, where rec devs are estimated one full generation prior to the first year when catch-at-age (CAA) data are available.
With <code>"comp"</code>, rec devs are estimated starting in the first year with CAA. With <code>"all"</code>, rec devs start at the beginning of the model.
If numeric, the number of years after the first year of the model for which to start estimating rec devs. Use negative numbers for years prior to the first year.</p></dd>


<dt id="arg-late-dev">late_dev<a class="anchor" aria-label="anchor" href="#arg-late-dev"></a></dt>
<dd><p>Typically, a numeric for the number of most recent years in which recruitment deviations will
not be estimated in <code>SCA</code> (recruitment in these years will be based on the mean predicted by stock-recruit relationship).
By default, <code>"comp50"</code> uses the number of ages (smaller than the mode)
for which the catch-at-age matrix has less than half the abundance than that at the mode.</p></dd>


<dt id="arg-integrate">integrate<a class="anchor" aria-label="anchor" href="#arg-integrate"></a></dt>
<dd><p>Logical, whether the likelihood of the model integrates over the likelihood
of the recruitment deviations (thus, treating it as a random effects/state-space variable).
Otherwise, recruitment deviations are penalized parameters.</p></dd>


<dt id="arg-silent">silent<a class="anchor" aria-label="anchor" href="#arg-silent"></a></dt>
<dd><p>Logical, passed to <code><a href="https://rdrr.io/pkg/TMB/man/MakeADFun.html" class="external-link">TMB::MakeADFun()</a></code>, whether TMB
will print trace information during optimization. Used for diagnostics for model convergence.</p></dd>


<dt id="arg-opt-hess">opt_hess<a class="anchor" aria-label="anchor" href="#arg-opt-hess"></a></dt>
<dd><p>Logical, whether the hessian function will be passed to <code><a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">stats::nlminb()</a></code> during optimization
(this generally reduces the number of iterations to convergence, but is memory and time intensive and does not guarantee an increase
in convergence rate). Ignored if <code>integrate = TRUE</code>.</p></dd>


<dt id="arg-n-restart">n_restart<a class="anchor" aria-label="anchor" href="#arg-n-restart"></a></dt>
<dd><p>The number of restarts (calls to <code><a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">stats::nlminb()</a></code>) in the optimization procedure, so long as the model
hasn't converged. The optimization continues from the parameters from the previous (re)start.</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>A named list of arguments for optimization to be passed to
<code><a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">stats::nlminb()</a></code>.</p></dd>


<dt id="arg-inner-control">inner.control<a class="anchor" aria-label="anchor" href="#arg-inner-control"></a></dt>
<dd><p>A named list of arguments for optimization of the random effects, which
is passed on to <code><a href="https://rdrr.io/pkg/TMB/man/newton.html" class="external-link">TMB::newton()</a></code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other arguments to be passed.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="online-documentation">Online Documentation<a class="anchor" aria-label="anchor" href="#online-documentation"></a></h2>


<p>Model description and equations are available on the openMSE
<a href="https://openmse.com/features-assessment-models/2-sca/" class="external-link">website</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Q. Huynh</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Quang Huynh, Tom Carruthers, Adrian Hordyk.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

