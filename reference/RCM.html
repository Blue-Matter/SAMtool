<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Rapid Conditioning Model (RCM) — check_RCMdata • SAMtool</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Rapid Conditioning Model (RCM) — check_RCMdata"><meta property="og:description" content="Intended for conditioning operating models for MSEtool. For data-limited stocks, this function can generate a range of potential depletion scenarios inferred from sparse data.
From a historical time series of total catch or effort, and potentially age/length compositions and multiple indices of abundance, the RCM returns a range of values for depletion, selectivity,
unfished recruitment (R0), historical fishing effort, and recruitment deviations for the operating model. This is done by sampling life history parameters
provided by the user and fitting a statistical catch-at-age model (with the predicted catch equal to the observed catch).
Alternatively one can do a single model fit and sample the covariance matrix to generate an operating model with uncertainty based on the model fit.
Either a full catch (conditioned on catch) or effort (conditioned on effort) time series is needed but missing data (as NAs) are allowed for all other data types.
check_RCMdata evaluates whether the inputs in the S4 RCMdata object are correctly formatted."><meta property="og:image" content="https://SAMtool.openMSE.com/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SAMtool</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.5.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/Blue-Matter/SAMtool/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Rapid Conditioning Model (RCM)</h1>
    <small class="dont-index">Source: <a href="https://github.com/Blue-Matter/SAMtool/blob/HEAD/R/RCM_data.R" class="external-link"><code>R/RCM_data.R</code></a>, <a href="https://github.com/Blue-Matter/SAMtool/blob/HEAD/R/define_S4_generic_RCM.R" class="external-link"><code>R/define_S4_generic_RCM.R</code></a></small>
    <div class="hidden name"><code>RCM.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Intended for conditioning operating models for MSEtool. For data-limited stocks, this function can generate a range of potential depletion scenarios inferred from sparse data.
From a historical time series of total catch or effort, and potentially age/length compositions and multiple indices of abundance, the RCM returns a range of values for depletion, selectivity,
unfished recruitment (R0), historical fishing effort, and recruitment deviations for the operating model. This is done by sampling life history parameters
provided by the user and fitting a statistical catch-at-age model (with the predicted catch equal to the observed catch).
Alternatively one can do a single model fit and sample the covariance matrix to generate an operating model with uncertainty based on the model fit.
Either a full catch (conditioned on catch) or effort (conditioned on effort) time series is needed but missing data (as NAs) are allowed for all other data types.
<code>check_RCMdata</code> evaluates whether the inputs in the S4 RCMdata object are correctly formatted.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">check_RCMdata</span><span class="op">(</span></span>
<span>  <span class="va">RCMdata</span>,</span>
<span>  <span class="va">OM</span>,</span>
<span>  condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"catch"</span>, <span class="st">"catch2"</span>, <span class="st">"effort"</span><span class="op">)</span>,</span>
<span>  silent <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">RCM</span><span class="op">(</span><span class="va">OM</span>, <span class="va">data</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for OM,RCMdata</span></span>
<span><span class="fu">RCM</span><span class="op">(</span></span>
<span>  <span class="va">OM</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"catch"</span>, <span class="st">"catch2"</span>, <span class="st">"effort"</span><span class="op">)</span>,</span>
<span>  selectivity <span class="op">=</span> <span class="st">"logistic"</span>,</span>
<span>  s_selectivity <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  LWT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  comp_like <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"multinomial"</span>, <span class="st">"lognormal"</span>, <span class="st">"mvlogistic"</span>, <span class="st">"dirmult1"</span>, <span class="st">"dirmult2"</span><span class="op">)</span>,</span>
<span>  prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  max_F <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  integrate <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  mean_fit <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  drop_nonconv <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  drop_highF <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>iter.max <span class="op">=</span> <span class="fl">2e+05</span>, eval.max <span class="op">=</span> <span class="fl">4e+05</span><span class="op">)</span>,</span>
<span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  silent <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for OM,list</span></span>
<span><span class="fu">RCM</span><span class="op">(</span></span>
<span>  <span class="va">OM</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"catch"</span>, <span class="st">"catch2"</span>, <span class="st">"effort"</span><span class="op">)</span>,</span>
<span>  selectivity <span class="op">=</span> <span class="st">"logistic"</span>,</span>
<span>  s_selectivity <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  LWT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  comp_like <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"multinomial"</span>, <span class="st">"lognormal"</span>, <span class="st">"mvlogistic"</span>, <span class="st">"dirmult1"</span>, <span class="st">"dirmult2"</span><span class="op">)</span>,</span>
<span>  ESS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">30</span><span class="op">)</span>,</span>
<span>  prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  max_F <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  integrate <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  mean_fit <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  drop_nonconv <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  drop_highF <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>iter.max <span class="op">=</span> <span class="fl">2e+05</span>, eval.max <span class="op">=</span> <span class="fl">4e+05</span><span class="op">)</span>,</span>
<span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  silent <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for OM,Data</span></span>
<span><span class="fu">RCM</span><span class="op">(</span></span>
<span>  <span class="va">OM</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"catch"</span>, <span class="st">"catch2"</span>, <span class="st">"effort"</span><span class="op">)</span>,</span>
<span>  selectivity <span class="op">=</span> <span class="st">"logistic"</span>,</span>
<span>  s_selectivity <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  LWT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  comp_like <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"multinomial"</span>, <span class="st">"lognormal"</span>, <span class="st">"mvlogistic"</span>, <span class="st">"dirmult1"</span>, <span class="st">"dirmult2"</span><span class="op">)</span>,</span>
<span>  ESS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">30</span><span class="op">)</span>,</span>
<span>  prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  max_F <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  integrate <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  mean_fit <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  drop_nonconv <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  drop_highF <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>iter.max <span class="op">=</span> <span class="fl">2e+05</span>, eval.max <span class="op">=</span> <span class="fl">4e+05</span><span class="op">)</span>,</span>
<span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  silent <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>RCMdata</dt>
<dd><p>An <a href="RCMdata-class.html">RCMdata</a> object.</p></dd>


<dt>OM</dt>
<dd><p>An object of class OM that specifies natural mortality (M), growth (Linf, K, t0, a, b), stock-recruitment relationship,
steepness, maturity parameters (L50 and L50_95), standard deviation of recruitment variability (Perr), as well as index uncertainty (Iobs).</p></dd>


<dt>condition</dt>
<dd><p>String to indicate whether the RCM is conditioned on "catch" (where F are estimated parameters), "catch2" (where F is solved internally using Newton's method),
or "effort".</p></dd>


<dt>silent</dt>
<dd><p>Logical to indicate whether informative messages will be reported to console.</p></dd>


<dt>data</dt>
<dd><p>Data inputs formatted in a <a href="RCMdata-class.html">RCMdata</a> (preferred) or Data object. 
Use of a list is deprecated. See Data section below.</p></dd>


<dt>...</dt>
<dd><p>Other arguments to pass in for starting values of parameters and fixing parameters. See details.</p></dd>


<dt>selectivity</dt>
<dd><p>A character vector of length nfleet to indicate <code>"logistic"</code>, <code>"dome"</code>, or <code>"free"</code> selectivity for each fleet in <code>Chist</code>.
If there is time-varying selectivity, this is a character vector of length nsel_block (see Data section below). "free" indicates independent selectivity parameters for each age,
and additional modifications for fixing selectivity parameters will likely be needed. See Additional arguments section.</p></dd>


<dt>s_selectivity</dt>
<dd><p>A vector of length nsurvey to indicate the selectivity of the corresponding columns in <code>data$Index</code>. Use <code>"B"</code> for
total biomass, or <code>"SSB"</code> for spawning biomass (by default, "B" is used). Use numbers if the survey selectivity follows a fleet (corresponding to the columns in data$Chist, e.g., 1 = first fleet/column and so on).
If the survey selectivity is otherwise independent of anything else in the model, use <code>"logistic"</code>, <code>"dome"</code>, or <code>"free"</code> to specify the functional form of selectivity, and
see Additional arguments section for setup of survey selectivity parameters and Articles section for more information.</p></dd>


<dt>LWT</dt>
<dd><p>A named list of likelihood weights for the RCM. See below.</p></dd>


<dt>comp_like</dt>
<dd><p>A string indicating the statistical distribution for the composition data, either <code>"multinomial"</code> (default), <code>"lognormal"</code>, <code>"mvlogistic"</code> (multivariate logistic),
<code>"dirmult1"</code> (Dirichlet multinomial, linear version), or <code>"dirmult2"</code> (saturating version; see Thorson et al. 2017).</p></dd>


<dt>prior</dt>
<dd><p>A named list for the parameters of any priors to be added to the model. See below.</p></dd>


<dt>max_F</dt>
<dd><p>The maximum F for any fleet in the scoping model (higher F's in the model are penalized in the objective function). This argument will also update <code>OM@maxF</code>. See also <code>drop_highF</code>.</p></dd>


<dt>cores</dt>
<dd><p>Integer for the number of CPU cores (set greater than 1 for parallel processing).</p></dd>


<dt>integrate</dt>
<dd><p>Logical, whether to treat recruitment deviations as penalized parameters in the likelihood (FALSE) or random effects to be marginalized out of the likelihood (TRUE).</p></dd>


<dt>mean_fit</dt>
<dd><p>Logical, whether to run an additional with mean values of life history parameters from the OM.</p></dd>


<dt>drop_nonconv</dt>
<dd><p>Logical, whether to drop non-converged fits of the RCM, including fits where F = NA.</p></dd>


<dt>drop_highF</dt>
<dd><p>Logical, whether to drop fits of the RCM where F = <code>max_F</code>.</p></dd>


<dt>control</dt>
<dd><p>A named list of arguments (e.g, max. iterations, etc.) for optimization, to be passed to the control argument of <code><a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">nlminb</a></code>.</p></dd>


<dt>start</dt>
<dd><p>A list of starting values for the TMB model. See details.</p></dd>


<dt>map</dt>
<dd><p>A list of <code>map</code> argument to TMB models to override defaults. See <a href="https://rdrr.io/pkg/TMB/man/MakeADFun.html" class="external-link">MakeADFun</a> and details.</p></dd>


<dt>ESS</dt>
<dd><p>A vector of length two. A shortcut method to setting the maximum multinomial sample size of the age and length compositions. 
Not used when data are provided in a <a href="RCMdata-class.html">RCMdata</a> object.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An object of class <a href="RCModel-class.html">RCModel</a> (see link for description of output).</p>


<p><code>check_RCMdata</code> returns a list of updated RCMdata object, OM, and StockPars, ObsPars, and FleetPars from the Hist object generated
from the OM.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Fleet selectivity is fixed to values sampled from <code>OM</code> if no age or length compositions are provided.</p>
<p>Survey selectivity is estimable only if <code>IAA</code> or <code>IAL</code> is provided. Otherwise, the selectivity should
be mirrored to a fleet (vulnerable biomass selectivity) or indexed to total or spawning biomass (see <code>s_selectivity</code>).</p>
<p>Parameters that were used in the fitting model are placed in the <code>RCM@OM@cpars</code> list.</p>
<p>If the operating model <code>OM</code> uses time-varying growth or M, then those trends will be used in the RCM as well.
Non-stationary productivity creates ambiguity in the calculation and interpretation of depletion and MSY reference points.</p>
<p>The easiest way to turn off time-varying growth/M is by setting: <code>OM@Msd &lt;- OM@Linfsd &lt;- OM@Ksd &lt;- c(0, 0)</code>.</p>
<p>To play with alternative fits by excluding indices, for example, or other optional data, set the corresponding likelihood weight to zero. The model will still generate the inferred
index but the data won't enter the likelihood. See section on likelihood weights.</p>
    </div>
    <div id="priors">
    <h2>Priors</h2>
    

<p>The following priors can be added as a named list, e.g., <code>prior = list(M = c(0.25, 0.15), h = c(0.7, 0.1)</code>. 
For each parameter below, provide a vector of values as described:</p>
<ul><li><p><code>R0</code> - A vector of length 3. The first value indicates the distribution of the prior: <code>1</code> for lognormal, <code>2</code> for uniform
on <code>log(R0)</code>, <code>3</code> for uniform on R0. If lognormal, the second and third values are the prior mean (in normal space) and SD (in log space).
Otherwise, the second and third values are the lower and upper bounds of the uniform distribution (values in normal space).</p></li>
<li><p><code>h</code> - A vector of length 2 for the prior mean and SD, both in normal space. Beverton-Holt steepness uses a beta distribution, 
while Ricker steepness uses a normal distribution.</p></li>
<li><p><code>M</code> - A vector of length 2 for the prior mean (in normal space) and SD (in log space). Lognormal prior.</p></li>
<li><p><code>q</code> - A matrix for nsurvey rows and 2 columns. The first column is the prior mean (in normal space) and the second column 
for the SD (in log space). Use <code>NA</code> in rows corresponding to indices without priors.</p></li>
</ul><p>See online documentation for more details.</p>
    </div>
    <div id="online-documentation">
    <h2>Online Documentation</h2>
    

<p>Several articles are available for the RCM:</p>
<ul><li><p><a href="https://openmse.com/tutorial-rcm/" class="external-link">General overview of approach</a></p></li>
<li><p><a href="https://openmse.com/tutorial-rcm-eq/" class="external-link">Mathematical description</a></p></li>
<li><p><a href="https://openmse.com/tutorial-rcm-select/" class="external-link">Setup of selectivity settings</a> (useful for more data-rich cases)</p></li>
<li><p><a href="https://openmse.com/features-assessment-models/5-priors/" class="external-link">Description of priors</a></p></li>
</ul></div>
    <div id="data">
    <h2>Data</h2>
    

<p>One of indices, age compositions, or length compositions should be provided in addition to the historical catch or effort. Not all arguments
are needed to run the model (some have defaults, while others are ignored if not applicable depending on the data provided).</p>
<p>The <code>data</code> variable can be an object of class <a href="RCMdata-class.html">RCMdata</a>. See help file for description of inputs.</p>
<p>Alternatively, the <code>data</code> input can be a Data S4 object which will retrieve data from the following slots:</p>
<ul><li><p>Data@Cat - catch series (single fleet with the Data S4 object)</p></li>
<li><p>Data@Effort - effort series</p></li>
<li><p>Data@CAA - fishery age composition</p></li>
<li><p>Data@CAL, Data@CAL_mids - fishery length composition and corresponding length bins</p></li>
<li><p>Data@Ind, Data@SpInd, Data@VInd, Data@AddInd - indices of abundance</p></li>
<li><p>Data@CV_Ind, Data@CV_SpInd, Data@CV_VInd, Data@CV_AddInd - annual coefficients of variation for the corresponding indices of abundance. CVs will be converted to lognormal standard deviations.</p></li>
<li><p>Data@ML - fishery mean lengths</p></li>
<li><p>Data@AddIndV, Data@AddIndType, Data@AddIunits - Additional information for indices in Data@AddInd: selectivity and units (i.e., biomass or abundance).</p></li>
</ul><p>There is no slot in the Data S4 object for the equilibrium catch/effort. These can be passed directly in the function call, i.e., <code>RCM(OM, Data, C_eq = C_eq, ...)</code>.</p>
<p>Use of a list is deprecated. For backwards compatibility, here is the list of supported entries:</p>
<ul><li><p>Chist - A vector of historical catch, should be of length OM@nyears. If there are multiple fleets: a matrix of OM@nyears rows and nfleet columns.
Ideally, the first year of the catch series represents unfished conditions (see also <code>C_eq</code>).</p></li>
<li><p>C_sd - A vector or matrix of standard deviations (lognormal distribution) for the catches in <code>Chist</code>.
If not provided, the default is 0.01. Only used if <code>condition = "catch"</code>.</p></li>
<li><p>Ehist - A vector of historical effort, should be of length OM@nyears (see also <code>E_eq</code>).</p></li>
<li><p>Index - A vector of values of an index (of length OM@nyears). If there are multiple indices: a matrix of historical indices of abundances, with rows
indexing years and columns indexing the index.</p></li>
<li><p>I_sd - A vector or matrix of standard deviations (lognormal distribution) for the indices corresponding to the entries in <code>Index</code>.
If not provided, this function will use values from <code>OM@Iobs</code>.</p></li>
<li><p>I_type - Obsolete as of version 2.0. See <code>s_selectivity</code> argument.</p></li>
<li><p>CAA - Fishery age composition matrix with nyears rows and OM@maxage+1 columns. If multiple fleets: an array with dimension: nyears, OM@maxage, and nfleets.</p></li>
<li><p>CAL - Fishery length composition matrix with nyears rows and columns indexing the length bin. If multiple fleets: an array with dimension: nyears,
length bins, and nfleets.</p></li>
<li><p>MS - A vector of fishery mean size (MS, either mean length or mean weight) observations (length OM@nyears), or if multiple fleets: matrix of dimension: nyears and nfleets.
Generally, mean lengths should not be used if <code>CAL</code> is also provided, unless mean length and length comps are independently sampled.</p></li>
<li><p>MS_type - A character (either <code>"length"</code> (default) or <code>"weight"</code>) to denote the type of mean size data.</p></li>
<li><p>MS_cv - The coefficient of variation of the observed mean size. If there are multiple fleets, a vector of length nfleet.
Default is 0.2.</p></li>
<li><p>s_CAA - Survey age composition data, an array of dimension nyears, maxage+1, nsurvey.</p></li>
<li><p>s_CAL - Survey length composition data, an array of dimension nyears, length(length_bin), nsurvey.</p></li>
<li><p>length_bin - A vector for the midpoints of the length bins for <code>CAL</code> and <code>s_CAL</code>. All bin widths should be equal in size.</p></li>
<li><p>C_eq - A numeric vector of length nfleet for the equilibrium catch for each fleet in <code>Chist</code> prior to the first year of the operating model.
Zero (default) implies unfished conditions in year one. Otherwise, this is used to estimate depletion in the first year of the data. Alternatively,
if one has a full CAA matrix, one could instead estimate "artificial" rec devs to generate the initial numbers-at-age (and hence initial depletion) in the first year of the model (see additional arguments).</p></li>
<li><p>C_eq_sd - A vector of standard deviations (lognormal distribution) for the equilibrium catches in <code>C_eq</code>.
If not provided, the default is 0.01. Only used if <code>condition = "catch"</code>.</p></li>
<li><p>E_eq - The equilibrium effort for each fleet in <code>Ehist</code> prior to the first year of the operating model.
Zero (default) implies unfished conditions in year one. Otherwise, this is used to estimate depletion in the first year of the data.</p></li>
<li><p>abs_I - Optional, an integer vector to indicate which indices are in absolute magnitude. Use 1 to set q = 1, otherwise use 0 to estimate q.</p></li>
<li><p>I_units - Optional, an integer vector to indicate whether indices are biomass based (1) or abundance-based (0). By default, all are biomass-based.</p></li>
<li><p>age_error - Optional, a square matrix of maxage + 1 rows and columns to specify ageing error. The aa-th column assigns a proportion of the true age in the
a-th row to observed age. Thus, all rows should sum to 1. Default is an identity matrix (no ageing error).</p></li>
<li><p>sel_block - Optional, for time-varying fleet selectivity (in time blocks), a integer matrix of nyears rows and nfleet columns to assigns a selectivity function to a fleet for certain years.</p></li>
</ul></div>
    <div id="additional-arguments">
    <h2>Additional arguments</h2>
    

<p>For <code>RCM</code>, additional arguments can be passed to the model via <code>...</code>:</p>
<ul><li><p>plusgroup: Logical for whether the maximum age is a plusgroup or not. By default, TRUE.</p></li>
<li><p>fix_dome: Logical for whether the dome selectivity parameter for fleets is fixed. Used primarily for backwards compatibility, this is overridden by map_vul_par.</p></li>
<li><p>resample: Logical, whether the OM conditioning parameters (recruitment, fishing mortality, SSB, selectivity, etc.) are obtained by sampling the Hessian matrix from
a single model fit. By default FALSE. This feature requires identical biological parameters among simulations.</p></li>
</ul></div>
    <div id="start-and-map">
    <h2>start and map</h2>
    

<p>Starting values can be specified in a named list for the following:</p><ul><li><p>vul_par: A matrix of 3 rows and nfleet columns for starting values for fleet selectivity. The three rows correspond
to LFS (length of full selectivity), L5 (length of 5 percent selectivity), and Vmaxlen (selectivity at length Linf). By default,
the starting values are values from the OM object. If any selectivity = "free", then this matrix needs to be of maxage+1 rows where
the row specifies the selectivity at age. See Articles section.</p></li>
<li><p>ivul_par: A matrix of 3 rows and nsurvey columns for starting values for fleet selectivity. Same setup as vul_par. Values in the column are ignored
if <code>s_selectivity</code> is mapped to a fishing fleet (add NA placeholders in that case). 
If any <code>s_selectivity = "free"</code>, then this matrix needs to be of maxage+1 rows where
the row specifies the selectivity at age.</p></li>
<li><p>log_rec_dev: A numeric vector of length nyears for the starting values of the log-recruitment deviations.</p></li>
<li><p>log_early_rec_dev: A numeric vector of length OM@maxage for the starting values of the recruitment deviations controlling the abundance-at-age in the first year of the model.</p></li>
</ul><p>Parameters can be fixed with the map argument (also a named list, corresponding to the start list). Each
vector or matrix in the map argument will be the same dimension as in the start entry. If an entry is <code>NA</code>, the corresponding parameter is fixed in the model to the starting
value. Otherwise, an integer for each independent parameter, i.e., shared or mirrored parameters get the same integer entry.</p>
<ul><li><p>vul_par: An integer matrix of the same dimension as vul_par. By default, selectivity is fixed if there are no age or length composition for that fleet
or survey, otherwise estimated. Unused cells in the vul_par matrix should be given NA in the map matrix.</p></li>
<li><p>ivul_par: The map argument for the survey selectivity parameters (same dimension as ivul_par). Placeholder parameters should have a map value of NA.</p></li>
<li><p>log_early_rec_dev: A vector of length OM@maxage that indexes which recruitment deviates for the cohorts in the first year of the model are fixed (using NA) or estimated (a separate integer).
By default, no deviates are estimated (all are NA).</p></li>
<li><p>log_rec_dev: A vector of length OM@nyears that indexes which recruitment deviates are fixed (using NA) or estimated (a separate integer).
By default, all these deviates are estimated.</p></li>
</ul></div>
    <div id="likelihood-weights">
    <h2>Likelihood weights</h2>
    

<p><code>LWT</code> is an optional named list containing the likelihood weights (values &gt;= 0) with the possible options:</p><ul><li><p>Chist, CAA, CAL, MS, C_eq: A vector of length nfleet for each.</p></li>
<li><p>Index, IAA, IAL: A vector of length nsurvey for each.</p></li>
</ul><p>By default, all likelihood weights are equal to one if not specified by the user.</p>
<p>Annual multinomial sample sizes for the age and length comps can now be provided directly in the 
<a href="RCMdata-class.html">RCMdata</a> object. For a list or Data object, use the <code>ESS</code> argument.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Thorson et al. 2017. Model-based estimates of effective sample size in stock assessment models using the Dirichlet-multinomial distribution.
Fish. Res. 192:84-93. <a href="https://doi.org/10.1016/j.fishres.2016.06.005" class="external-link">doi:10.1016/j.fishres.2016.06.005</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="plot.RCModel.html">plot.RCModel</a> <a href="RCModel-class.html">RCModel</a> <a href="plot.RCModel.html">compare_RCM</a> <a href="pcod.html">pcod</a> <a href="RCM2MOM.html">RCM2MOM</a> <a href="posterior.html">posterior</a></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Q. Huynh</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{ </span></span></span>
<span class="r-in"><span><span class="co"># An example that conditions a Pacific cod operating model. There are 48 simulations, </span></span></span>
<span class="r-in"><span><span class="co"># where values of natural mortality and steepness are sampled from distributions. </span></span></span>
<span class="r-in"><span><span class="co"># The model is fitted with priors on the index catchability. Maturity and selectivity </span></span></span>
<span class="r-in"><span><span class="co"># are knife-edge at the age of 2 years. See online tutorial for more information.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">pcod</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">mat_ogive</span> <span class="op">&lt;-</span> <span class="va">pcod</span><span class="op">$</span><span class="va">OM</span><span class="op">@</span><span class="va">cpars</span><span class="op">$</span><span class="va">Mat_age</span><span class="op">[</span><span class="fl">1</span>, , <span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">RCM</span><span class="op">(</span>OM <span class="op">=</span> <span class="va">pcod</span><span class="op">$</span><span class="va">OM</span>, data <span class="op">=</span> <span class="va">pcod</span><span class="op">$</span><span class="va">data</span>, </span></span>
<span class="r-in"><span>           condition <span class="op">=</span> <span class="st">"catch"</span>, mean_fit <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>           selectivity <span class="op">=</span> <span class="st">"free"</span>, s_selectivity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"SSB"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">pcod</span><span class="op">$</span><span class="va">data</span><span class="op">@</span><span class="va">Index</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>vul_par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">mat_ogive</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mat_ogive</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>vul_par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mat_ogive</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      log_early_rec_dev <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">pcod</span><span class="op">$</span><span class="va">OM</span><span class="op">@</span><span class="va">maxage</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           prior <span class="op">=</span> <span class="va">pcod</span><span class="op">$</span><span class="va">prior</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Checking OM and data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> RCM is conditioned on: catch</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> 65 years of data detected.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> First year in model: 1956</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Last year in model: 2020</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> 1 fleet(s) detected.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> 5 survey(s) detected.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Checking OM and getting biological parameters...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Mean weight data found.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Maximum F in RCM will be 3. OM@maxF is also updated.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> No fishery length or age compositions were provided. Selectivity is fixed to values from OM.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Fishery selectivity setup:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Fleet 1: individual parameters at age (free)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Index selectivity setup:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Index 1: spawning biomass</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Index 2: spawning biomass</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Index 3: spawning biomass</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Index 4: spawning biomass</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Index 5: spawning biomass</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Beverton-Holt stock-recruitment relationship used.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Prior for q found.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Fitting model (48 simulations) ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Generating additional model fit from mean values of parameters in the operating model...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Updating operating model:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Range of unfished age-0 recruitment (OM@cpars$R0): 6402.09 - 13658.66</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Range of initial spawning depletion: 0.46 - 1.52</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Range of spawning depletion (OM@cpars$D): 0.15 - 0.45</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Historical F set with OM@cpars$Find and OM@cpars$qs.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Annual selectivity set in OM@cpars$V. Projection period uses selectivity of last historical year.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Recruitment standard deviation set in OM@cpars$Perr: 0.8 - 0.8</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Historical recruitment deviations set in OM@cpars$Perr_y.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Range of recruitment autocorrelation OM@AC: 0.21 - 0.32</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Future recruitment deviations in OM@cpars$Perr_y sampled with autocorrelation.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Growth, maturity, natural mortality, and stock recruit parameters from RCM are set in OM@cpars.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Adding some RCMdata inputs into OM@cpars$Data:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Historical catch data added to OM@cpars$Data@Cat.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Historical indices added to OM@cpars$Data@AddInd.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Complete.</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out</span>, s_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">pcod</span><span class="op">$</span><span class="va">data</span><span class="op">@</span><span class="va">Index</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Generated markdown file: /var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpD7VZQ0/RCM.Rmd</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Rendering markdown file...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Rendered file: /private/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T/RtmpD7VZQ0/RCM.html</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Alternative OM with age-3 maturity and selectivity instead.</span></span></span>
<span class="r-in"><span><span class="va">out_age3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eval.html" class="external-link">local</a></span><span class="op">(</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">pcod</span><span class="op">$</span><span class="va">OM</span><span class="op">@</span><span class="va">cpars</span><span class="op">$</span><span class="va">Mat_age</span><span class="op">[</span>, <span class="fl">2</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span>  <span class="va">mat_ogive_age3</span> <span class="op">&lt;-</span> <span class="va">pcod</span><span class="op">$</span><span class="va">OM</span><span class="op">@</span><span class="va">cpars</span><span class="op">$</span><span class="va">Mat_age</span><span class="op">[</span><span class="fl">1</span>, , <span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="fu">RCM</span><span class="op">(</span>OM <span class="op">=</span> <span class="va">pcod</span><span class="op">$</span><span class="va">OM</span>, data <span class="op">=</span> <span class="va">pcod</span><span class="op">$</span><span class="va">data</span>, </span></span>
<span class="r-in"><span>      condition <span class="op">=</span> <span class="st">"catch"</span>, mean_fit <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>      selectivity <span class="op">=</span> <span class="st">"free"</span>, s_selectivity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"SSB"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">pcod</span><span class="op">$</span><span class="va">data</span><span class="op">@</span><span class="va">Index</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>vul_par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">mat_ogive_age3</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mat_ogive_age3</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>vul_par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mat_ogive_age3</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>,   </span></span>
<span class="r-in"><span>                 log_early_rec_dev <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">pcod</span><span class="op">$</span><span class="va">OM</span><span class="op">@</span><span class="va">maxage</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      prior <span class="op">=</span> <span class="va">pcod</span><span class="op">$</span><span class="va">prior</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Checking OM and data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> RCM is conditioned on: catch</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> 65 years of data detected.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> First year in model: 1956</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Last year in model: 2020</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> 1 fleet(s) detected.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> 5 survey(s) detected.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Checking OM and getting biological parameters...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Mean weight data found.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Maximum F in RCM will be 3. OM@maxF is also updated.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> No fishery length or age compositions were provided. Selectivity is fixed to values from OM.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Fishery selectivity setup:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Fleet 1: individual parameters at age (free)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Index selectivity setup:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Index 1: spawning biomass</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Index 2: spawning biomass</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Index 3: spawning biomass</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Index 4: spawning biomass</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Index 5: spawning biomass</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Beverton-Holt stock-recruitment relationship used.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Prior for q found.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Fitting model (48 simulations) ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Generating additional model fit from mean values of parameters in the operating model...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Updating operating model:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Range of unfished age-0 recruitment (OM@cpars$R0): 6402.09 - 13658.66</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Range of initial spawning depletion: 0.46 - 1.52</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Range of spawning depletion (OM@cpars$D): 0.15 - 0.45</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Historical F set with OM@cpars$Find and OM@cpars$qs.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Annual selectivity set in OM@cpars$V. Projection period uses selectivity of last historical year.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Recruitment standard deviation set in OM@cpars$Perr: 0.8 - 0.8</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Historical recruitment deviations set in OM@cpars$Perr_y.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Range of recruitment autocorrelation OM@AC: 0.21 - 0.32</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Future recruitment deviations in OM@cpars$Perr_y sampled with autocorrelation.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Growth, maturity, natural mortality, and stock recruit parameters from RCM are set in OM@cpars.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Adding some RCMdata inputs into OM@cpars$Data:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Historical catch data added to OM@cpars$Data@Cat.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Historical indices added to OM@cpars$Data@AddInd.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Complete.</span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="fu"><a href="plot.RCModel.html">compare_RCM</a></span><span class="op">(</span><span class="va">out</span>, <span class="va">out_age3</span>, scenario <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Age-2 maturity"</span>, <span class="st">"Age-3 maturity"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            s_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">pcod</span><span class="op">$</span><span class="va">data</span><span class="op">@</span><span class="va">Index</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Generated markdown file: /var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpD7VZQ0/compare_RCM.Rmd</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Rendering markdown file...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Rendered file: /private/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T/RtmpD7VZQ0/compare_RCM.html</span>
<span class="r-in"><span>             </span></span>
<span class="r-in"><span><span class="va">Hist</span> <span class="op">&lt;-</span> <span class="fu">runMSE</span><span class="op">(</span><span class="va">out</span><span class="op">@</span><span class="va">OM</span>, Hist <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>            </span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">ℹ</span> Checking OM for completeness</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Loading operating model</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">ℹ</span> Valid custom parameters found: </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    M </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   h </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   V </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Mat_age </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   R0 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   D </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Find </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   qs </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Perr </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   AC </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Perr_y </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Len_age </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Linf </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   K </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   t0 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   LenCV </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   LatASD </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Wt_age </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   hs </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   M_ageArray </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   AddIbeta </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Data </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Note: Maximum age (10) is lower than assuming 1% of cohort survives to maximum age (24)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Optimizing for user-specified movement</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Calculating MSY reference points for each year</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">ℹ</span> Skipping optimization for depletion - using catchability (q) from OM@cpars.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Calculating historical stock and fishing dynamics</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Calculating per-recruit reference points</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Calculating B-low reference points</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Calculating reference yield - best fixed F strategy</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Simulating observed data</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Updating Simulated Data with Real Data from `OM@cpars$Data`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">ℹ</span> Using `OM@cpars$Data@LenCV` (0.1)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Updating Simulated Catch from `OM@cpars$Data@Cat`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">ℹ</span> Updating Catch bias from `OM@cpars$Data@Cat`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">ℹ</span> Updating Catch variability from `OM@cpars$Data@Cat`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">ℹ</span> Updating catch observation error from `OM@cpars$Data@Cat`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Adding Additional Indices to Simulated Data from `OM@cpars$Data@AddInd`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">ℹ</span> cpars$AddIbeta detected. Not updating beta for additional indices</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">ℹ</span> Updating observation variability (AddIerr) for additional indices from real data</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">ℹ</span> Additional index 1 - spawning stock (biomass)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">ℹ</span> Additional index 2 - spawning stock (biomass)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">ℹ</span> Additional index 3 - spawning stock (biomass)</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>An error occurred in calculating statistical properties of fit to Additional Index 3 (possibly because there was only one observed data point). </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Using the index observation error for slot `Ind` from `Obs` object (or possibly conditioned if `cpars$Data@Ind` was provided).</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Use `cpars$AddIerr` to manually set the observation error.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">ℹ</span> Additional index 4 - spawning stock (biomass)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">ℹ</span> Additional index 5 - spawning stock (biomass)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Returning historical simulations</span>
<span class="r-in"><span><span class="co"># } </span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Quang Huynh, Tom Carruthers, Adrian Hordyk.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

