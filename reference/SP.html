<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Surplus production model with FMSY and MSY as leading parameters — SP • SAMtool</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Surplus production model with FMSY and MSY as leading parameters — SP"><meta name="description" content="A surplus production model that uses only a time-series of catches and a relative abundance index
and coded in TMB. The base model, SP, is conditioned on catch and estimates a predicted index.
Continuous surplus production and fishing is modeled with sub-annual time steps which should approximate
the behavior of ASPIC (Prager 1994). The Fox model, SP_Fox, fixes BMSY/K = 0.37 (1/e).
The state-space version, SP_SS estimates annual deviates in biomass. An option allows for setting a
prior for the intrinsic rate of increase.
The function for the spict model (Pedersen and Berg, 2016) is available in MSEextra."><meta property="og:description" content="A surplus production model that uses only a time-series of catches and a relative abundance index
and coded in TMB. The base model, SP, is conditioned on catch and estimates a predicted index.
Continuous surplus production and fishing is modeled with sub-annual time steps which should approximate
the behavior of ASPIC (Prager 1994). The Fox model, SP_Fox, fixes BMSY/K = 0.37 (1/e).
The state-space version, SP_SS estimates annual deviates in biomass. An option allows for setting a
prior for the intrinsic rate of increase.
The function for the spict model (Pedersen and Berg, 2016) is available in MSEextra."><meta property="og:image" content="https://samtool.openmse.com/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SAMtool</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Blue-Matter/SAMtool/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Surplus production model with FMSY and MSY as leading parameters</h1>
      <small class="dont-index">Source: <a href="https://github.com/Blue-Matter/SAMtool/blob/master/R/assess_SP.R" class="external-link"><code>R/assess_SP.R</code></a></small>
      <div class="d-none name"><code>SP.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A surplus production model that uses only a time-series of catches and a relative abundance index
and coded in TMB. The base model, <code>SP</code>, is conditioned on catch and estimates a predicted index.
Continuous surplus production and fishing is modeled with sub-annual time steps which should approximate
the behavior of ASPIC (Prager 1994). The Fox model, <code>SP_Fox</code>, fixes BMSY/K = 0.37 (1/e).
The state-space version, <code>SP_SS</code> estimates annual deviates in biomass. An option allows for setting a
prior for the intrinsic rate of increase.
The function for the <code>spict</code> model (Pedersen and Berg, 2016) is available in <a href="https://rdrr.io/pkg/MSEtool/man/MSEextra.html" class="external-link">MSEextra</a>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">SP</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">Data</span>,</span>
<span>  AddInd <span class="op">=</span> <span class="st">"B"</span>,</span>
<span>  rescale <span class="op">=</span> <span class="st">"mean1"</span>,</span>
<span>  start <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  fix_dep <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  fix_n <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  LWT <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_seas <span class="op">=</span> <span class="fl">4L</span>,</span>
<span>  n_itF <span class="op">=</span> <span class="fl">3L</span>,</span>
<span>  Euler_Lotka <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  SR_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BH"</span>, <span class="st">"Ricker"</span><span class="op">)</span>,</span>
<span>  silent <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  opt_hess <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  n_restart <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">opt_hess</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>iter.max <span class="op">=</span> <span class="fl">5000</span>, eval.max <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">SP_SS</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">Data</span>,</span>
<span>  AddInd <span class="op">=</span> <span class="st">"B"</span>,</span>
<span>  rescale <span class="op">=</span> <span class="st">"mean1"</span>,</span>
<span>  start <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  fix_dep <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  fix_n <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  fix_sigma <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  fix_tau <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  LWT <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  early_dev <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"all"</span>, <span class="st">"index"</span><span class="op">)</span>,</span>
<span>  n_seas <span class="op">=</span> <span class="fl">4L</span>,</span>
<span>  n_itF <span class="op">=</span> <span class="fl">3L</span>,</span>
<span>  Euler_Lotka <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  SR_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BH"</span>, <span class="st">"Ricker"</span><span class="op">)</span>,</span>
<span>  integrate <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  silent <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  opt_hess <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  n_restart <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">opt_hess</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>iter.max <span class="op">=</span> <span class="fl">5000</span>, eval.max <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span>,</span>
<span>  inner.control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">SP_Fox</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, <span class="va">Data</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An index for the objects in <code>Data</code> when running in <a href="https://rdrr.io/pkg/MSEtool/man/runMSE.html" class="external-link">runMSE</a>.
Otherwise, equals to 1 When running an assessment interactively.</p></dd>


<dt id="arg-data">Data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>An object of class Data.</p></dd>


<dt id="arg-addind">AddInd<a class="anchor" aria-label="anchor" href="#arg-addind"></a></dt>
<dd><p>A vector of integers or character strings indicating the indices to be used in the model. Integers assign the index to
the corresponding index in Data@AddInd, "B" (or 0) represents total biomass in Data@Ind, "VB" represents vulnerable biomass in
Data@VInd, and "SSB" represents spawning stock biomass in Data@SpInd.</p></dd>


<dt id="arg-rescale">rescale<a class="anchor" aria-label="anchor" href="#arg-rescale"></a></dt>
<dd><p>A multiplicative factor that rescales the catch in the assessment model, which
can improve convergence. By default, <code>"mean1"</code> scales the catch so that time series mean is 1, otherwise a numeric.
Output is re-converted back to original units.</p></dd>


<dt id="arg-start">start<a class="anchor" aria-label="anchor" href="#arg-start"></a></dt>
<dd><p>Optional list of starting values. Entries can be expressions that are evaluated in the function. See details.</p></dd>


<dt id="arg-prior">prior<a class="anchor" aria-label="anchor" href="#arg-prior"></a></dt>
<dd><p>A named list for the parameters of any priors to be added to the model. See details.</p></dd>


<dt id="arg-fix-dep">fix_dep<a class="anchor" aria-label="anchor" href="#arg-fix-dep"></a></dt>
<dd><p>Logical, whether to fix the initial depletion (ratio of biomass to carrying capacity in the
first year of the model). If <code>TRUE</code>, uses the value in <code>start</code>, otherwise equal to 1
(unfished conditions).</p></dd>


<dt id="arg-fix-n">fix_n<a class="anchor" aria-label="anchor" href="#arg-fix-n"></a></dt>
<dd><p>Logical, whether to fix the exponent of the production function. If <code>TRUE</code>,
uses the value in <code>start</code>, otherwise equal to <code>n = 2</code>, where the biomass at MSY
is half of carrying capacity.</p></dd>


<dt id="arg-lwt">LWT<a class="anchor" aria-label="anchor" href="#arg-lwt"></a></dt>
<dd><p>A vector of likelihood weights for each survey.</p></dd>


<dt id="arg-n-seas">n_seas<a class="anchor" aria-label="anchor" href="#arg-n-seas"></a></dt>
<dd><p>Integer, the number of seasons in the model for calculating continuous surplus production.</p></dd>


<dt id="arg-n-itf">n_itF<a class="anchor" aria-label="anchor" href="#arg-n-itf"></a></dt>
<dd><p>Integer, the number of iterations to solve F conditional on the observed catch given multiple seasons within an annual time step.
Ignored if <code>n_seas</code> = 1.</p></dd>


<dt id="arg-euler-lotka">Euler_Lotka<a class="anchor" aria-label="anchor" href="#arg-euler-lotka"></a></dt>
<dd><p>Integer. If greater than zero, the function will calculate a prior for the intrinsic rate of increase to use in the estimation model
(in lieu of an explicit prior in argument <code>prior</code>). The value of this argument specifies the number of stochastic samples used to calculate the prior SD.
See section on priors below.</p></dd>


<dt id="arg-sr-type">SR_type<a class="anchor" aria-label="anchor" href="#arg-sr-type"></a></dt>
<dd><p>If <code>use_r_prior = TRUE</code>, the stock-recruit relationship used to calculate the stock-recruit alpha parameter from
steepness and unfished spawners-per-recruit. Used to develop the r prior.</p></dd>


<dt id="arg-silent">silent<a class="anchor" aria-label="anchor" href="#arg-silent"></a></dt>
<dd><p>Logical, passed to <code><a href="https://rdrr.io/pkg/TMB/man/MakeADFun.html" class="external-link">TMB::MakeADFun()</a></code>, whether TMB
will print trace information during optimization. Used for diagnostics for model convergence.</p></dd>


<dt id="arg-opt-hess">opt_hess<a class="anchor" aria-label="anchor" href="#arg-opt-hess"></a></dt>
<dd><p>Logical, whether the hessian function will be passed to <code><a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">stats::nlminb()</a></code> during optimization
(this generally reduces the number of iterations to convergence, but is memory and time intensive and does not guarantee an increase
in convergence rate). Ignored if <code>integrate = TRUE</code>.</p></dd>


<dt id="arg-n-restart">n_restart<a class="anchor" aria-label="anchor" href="#arg-n-restart"></a></dt>
<dd><p>The number of restarts (calls to <code><a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">stats::nlminb()</a></code>) in the optimization procedure, so long as the model
hasn't converged. The optimization continues from the parameters from the previous (re)start.</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>A named list of parameters regarding optimization to be passed to
<code><a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">stats::nlminb()</a></code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>For <code>SP_Fox</code>, additional arguments to pass to <code>SP</code>.</p></dd>


<dt id="arg-fix-sigma">fix_sigma<a class="anchor" aria-label="anchor" href="#arg-fix-sigma"></a></dt>
<dd><p>Logical, whether the standard deviation of the index is fixed. If <code>TRUE</code>,
sigma is fixed to value provided in <code>start</code> (if provided), otherwise, value based on <code>Data@CV_Ind</code>.</p></dd>


<dt id="arg-fix-tau">fix_tau<a class="anchor" aria-label="anchor" href="#arg-fix-tau"></a></dt>
<dd><p>Logical, the standard deviation of the biomass deviations is fixed. If <code>TRUE</code>,
tau is fixed to value provided in <code>start</code> (if provided), otherwise, equal to 0.1.</p></dd>


<dt id="arg-early-dev">early_dev<a class="anchor" aria-label="anchor" href="#arg-early-dev"></a></dt>
<dd><p>Character string describing the years for which biomass deviations are estimated in <code>SP_SS</code>.
By default, deviations are estimated in each year of the model (<code>"all"</code>), while deviations could also be estimated
once index data are available (<code>"index"</code>).</p></dd>


<dt id="arg-integrate">integrate<a class="anchor" aria-label="anchor" href="#arg-integrate"></a></dt>
<dd><p>Logical, whether the likelihood of the model integrates over the likelihood
of the biomass deviations (thus, treating it as a state-space variable).</p></dd>


<dt id="arg-inner-control">inner.control<a class="anchor" aria-label="anchor" href="#arg-inner-control"></a></dt>
<dd><p>A named list of arguments for optimization of the random effects, which
is passed on to <a href="https://rdrr.io/pkg/TMB/man/newton.html" class="external-link">newton</a> via <code><a href="https://rdrr.io/pkg/TMB/man/MakeADFun.html" class="external-link">TMB::MakeADFun()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of <a href="Assessment-class.html">Assessment</a> containing objects and output from TMB.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For <code>start</code> (optional), a named list of starting values of estimates can be provided for:</p><ul><li><p><code>MSY</code> Maximum sustainable yield.. Otherwise, 300% of mean catch by default.</p></li>
<li><p><code>FMSY</code> Steepness. Otherwise, <code>Data@Mort[x]</code> or 0.2 is used.</p></li>
<li><p><code>dep</code> Initial depletion (B/B0) in the first year of the model. By default, 1.</p></li>
<li><p><code>n</code> The production function exponent that determines BMSY/B0. By default, 2 so that BMSY/B0 = 0.5.</p></li>
<li><p><code>sigma</code> Lognormal SD of the index (observation error). By default, 0.05. Not
used with multiple indices.</p></li>
<li><p><code>tau</code> Lognormal SD of the biomass deviations (process error) in <code>SP_SS</code>. By default, 0.1.</p></li>
</ul><p>Multiple indices are supported in the model.</p>
<p>Tip: to create the Fox model (Fox 1970), just fix n = 1. See example.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The model uses the Fletcher (1978) formulation and is parameterized with FMSY and MSY as
leading parameters. The default conditions assume unfished conditions in the first year of the time series
and a symmetric production function (n = 2).</p>
    </div>
    <div class="section level2">
    <h2 id="priors">Priors<a class="anchor" aria-label="anchor" href="#priors"></a></h2>


<p>The following priors can be added as a named list, e.g., prior = list(r = c(0.25, 0.15), MSY = c(50, 0.1). For each parameter below, provide a vector of values as described:</p>
<ul><li><p><code>r</code> - A vector of length 2 for the lognormal prior mean (normal space) and SD (lognormal space).</p></li>
<li><p><code>MSY</code> - A vector of length 2 for the lognormal prior mean (normal space) and SD (lognormal space).</p></li>
</ul><p>In lieu of an explicit r prior provided by the user, set argument <code>Euler_Lotka = TRUE</code> to calculate the prior mean and SD using
the Euler-Lotka method (Equation 15a of McAllister et al. 2001).
The Euler-Lotka method is modified to multiply the left-hand side of equation 15a by the alpha parameter of the
stock-recruit relationship (Stanley et al. 2009). Natural mortality and steepness are sampled in order to generate
a prior distribution for r. See <code>vignette("Surplus_production")</code> for more details.</p>
    </div>
    <div class="section level2">
    <h2 id="online-documentation">Online Documentation<a class="anchor" aria-label="anchor" href="#online-documentation"></a></h2>


<p>Model description and equations are available on the openMSE
<a href="https://openmse.com/features-assessment-models/3-sp/" class="external-link">website</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="required-data">Required Data<a class="anchor" aria-label="anchor" href="#required-data"></a></h2>


<ul><li><p><code>SP</code>: Cat, Ind</p></li>
<li><p><code>SP_SS</code>: Cat, Ind</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="optional-data">Optional Data<a class="anchor" aria-label="anchor" href="#optional-data"></a></h2>


<p><code>SP_SS</code>: CV_Ind</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Fletcher, R. I. 1978. On the restructuring of the Pella-Tomlinson system. Fishery Bulletin 76:515:521.</p>
<p>Fox, W.W. 1970. An exponential surplus-yield model for optimizing exploited fish populations. Transactions of the American Fisheries Society 99:80-88.</p>
<p>McAllister, M.K., Pikitch, E.K., and Babcock, E.A. 2001. Using demographic methods to construct Bayesian priors
for the intrinsic rate of increase in the Schaefer model and implications for stock rebuilding. Can. J. Fish.
Aquat. Sci. 58: 1871-1890.</p>
<p>Pedersen, M. W. and Berg, C. W. 2017. A stochastic surplus production model in continuous time. Fish and Fisheries. 18:226-243.</p>
<p>Pella, J. J. and Tomlinson, P. K. 1969. A generalized stock production model. Inter-Am. Trop. Tuna Comm., Bull. 13:419-496.</p>
<p>Prager, M. H. 1994. A suite of extensions to a nonequilibrium surplus-production model. Fishery Bulletin 92:374-389.</p>
<p>Stanley, R.D., M. McAllister, P. Starr and N. Olsen. 2009. Stock assessment for bocaccio (Sebastes
paucispinis) in British Columbia waters. DFO Can. Sci. Advis. Sec. Res. Doc. 2009/055. xiv + 200 p.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="SP_production.html">SP_production</a> <a href="plot.Assessment.html">plot.Assessment</a> <a href="summary.Assessment.html">summary.Assessment</a> <a href="retrospective.html">retrospective</a> <a href="profile.html">profile</a> <a href="make_MP.html">make_MP</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Q. Huynh</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">swordfish</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Observation-error surplus production model</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">SP</span><span class="op">(</span>Data <span class="op">=</span> <span class="va">swordfish</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Provide starting values, assume B/K = 0.875 in first year of model</span></span></span>
<span class="r-in"><span><span class="co"># and symmetrical production curve (n = 2)</span></span></span>
<span class="r-in"><span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dep <span class="op">=</span> <span class="fl">0.875</span>, n <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">SP</span><span class="op">(</span>Data <span class="op">=</span> <span class="va">swordfish</span>, start <span class="op">=</span> <span class="va">start</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">ℹ</span> Writing markdown file: /tmp/Rtmp84nwsp/report_SP.Rmd</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">ℹ</span> Rendering markdown file: /tmp/Rtmp84nwsp/report_SP.Rmd</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">ℹ</span> See help(plot.Assessment) to adjust report and file directory.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Rendered file: /tmp/Rtmp84nwsp/report_SP.html</span>
<span class="r-in"><span><span class="fu"><a href="profile.html">profile</a></span><span class="op">(</span><span class="va">res</span>, FMSY <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.4</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="SP-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An object of class "prof"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slot "Model":</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "SP"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slot "Name":</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "North Atlantic Swordfish (Source: ASPIC software)"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slot "Par":</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "FMSY"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slot "MLE":</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.2779916</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slot "grid":</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    FMSY      MSY          nll</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  0.10 14279.16 3.229494e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  0.11 14279.16 2.870962e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  0.12 14279.16 2.530610e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  0.13 14279.16 2.209910e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  0.14 14279.16 1.909978e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  0.15 14279.16 1.631634e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  0.16 14279.16 1.375443e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  0.17 14279.16 1.141752e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  0.18 14279.16 9.307120e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 0.19 14279.16 7.423049e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 0.20 14279.16 5.763609e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 0.21 14279.16 4.325774e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 0.22 14279.16 3.105355e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 0.23 14279.16 2.097149e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 0.24 14279.16 1.295084e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 0.25 14279.16 6.923471e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 0.26 14279.16 2.815079e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 0.27 14279.16 5.463285e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 0.28 14279.16 3.392047e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 0.29 14279.16 1.191583e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 0.30 14279.16 3.930994e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 0.31 14279.16 8.162629e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 0.32 14279.16 1.999949e+01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 0.33 14279.16 2.074303e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 0.34 14279.16 5.523536e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26 0.35 14279.16 3.822012e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27 0.36 14279.16 2.003749e+01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 0.37 14279.16 2.004625e+01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29 0.38 14279.16 2.005471e+01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 0.39 14279.16 1.466457e+01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31 0.40 14279.16 2.007081e+01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="retrospective.html">retrospective</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="SP-2.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="SP-3.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="SP-4.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="SP-5.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Mohn's rho</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fishing mortality      0.129</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F/F[MSY]              -0.145</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Biomass               -0.091</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B/B[MSY]               0.152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B/B[0]                 0.152</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### State-space version</span></span></span>
<span class="r-in"><span><span class="va">res_SS</span> <span class="op">&lt;-</span> <span class="fu">SP_SS</span><span class="op">(</span>Data <span class="op">=</span> <span class="va">swordfish</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dep <span class="op">=</span> <span class="fl">0.875</span>, sigma <span class="op">=</span> <span class="fl">0.1</span>, tau <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_SS</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">ℹ</span> Writing markdown file: /tmp/Rtmp84nwsp/report_SP_SS.Rmd</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">ℹ</span> Rendering markdown file: /tmp/Rtmp84nwsp/report_SP_SS.Rmd</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">ℹ</span> See help(plot.Assessment) to adjust report and file directory.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Rendered file: /tmp/Rtmp84nwsp/report_SP_SS.html</span>
<span class="r-plt img"><img src="SP-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Fox model</span></span></span>
<span class="r-in"><span><span class="va">res_Fox</span> <span class="op">&lt;-</span> <span class="fu">SP</span><span class="op">(</span>Data <span class="op">=</span> <span class="va">swordfish</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, fix_n <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res_Fox2</span> <span class="op">&lt;-</span> <span class="fu">SP_Fox</span><span class="op">(</span>Data <span class="op">=</span> <span class="va">swordfish</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### SP with r prior calculated internally (100 stochastic samples to get prior SD)</span></span></span>
<span class="r-in"><span><span class="va">res_prior</span> <span class="op">&lt;-</span> <span class="fu">SP</span><span class="op">(</span>Data <span class="op">=</span> <span class="va">SimulatedData</span>, Euler_Lotka <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Pass an r prior to the model with mean = 0.35, lognormal sd = 0.10</span></span></span>
<span class="r-in"><span><span class="va">res_prior2</span> <span class="op">&lt;-</span> <span class="fu">SP</span><span class="op">(</span>Data <span class="op">=</span> <span class="va">SimulatedData</span>, prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>r <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.35</span>, <span class="fl">0.10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Pass MSY prior to the model with mean = 1500, lognormal sd = 0.05</span></span></span>
<span class="r-in"><span><span class="va">res_prior3</span> <span class="op">&lt;-</span> <span class="fu">SP</span><span class="op">(</span>Data <span class="op">=</span> <span class="va">SimulatedData</span>, prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>MSY <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1500</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Quang Huynh, Tom Carruthers, Adrian Hordyk.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

