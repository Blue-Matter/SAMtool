<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>SCA with random walk in M — SCA_RWM • SAMtool</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="SCA with random walk in M — SCA_RWM" />
<meta property="og:description" content="SCA_RWM is a modification of SCA that incorporates a random walk in M in logit space (constant with age). 
Set the variance to a small value (0.001) in order to fix M for all years, which is functionally equivalent to SCA." />
<meta property="og:image" content="https://SAMtool.openMSE.com/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SAMtool</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/SAMtool.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Delay_difference.html">1a. Delay-difference and delay-differential models</a>
    </li>
    <li>
      <a href="../articles/RCM.html">2. Description of the RCM (Rapid Conditioning Model) for conditioning MSEtool operating models</a>
    </li>
    <li>
      <a href="../articles/RCM_eq.html">2a. Mathematical description of the RCM</a>
    </li>
    <li>
      <a href="../articles/RCM_sel.html">2b. Configuring selectivity for the RCM</a>
    </li>
    <li>
      <a href="../articles/SCA.html">1b. Statistical catch-at-age (SCA) model</a>
    </li>
    <li>
      <a href="../articles/Surplus_production.html">1c. Surplus production model</a>
    </li>
    <li>
      <a href="../articles/VPA.html">1d. Virtual population analysis (VPA)</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/Blue-Matter/SAMtool/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>SCA with random walk in M</h1>
    <small class="dont-index">Source: <a href='https://github.com/Blue-Matter/SAMtool/blob/master/R/assess_SCA_RWM.R'><code>R/assess_SCA_RWM.R</code></a></small>
    <div class="hidden name"><code>SCA_RWM.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>SCA_RWM</code> is a modification of <a href='SCA.html'>SCA</a> that incorporates a random walk in M in logit space (constant with age). 
Set the variance to a small value (0.001) in order to fix M for all years, which is functionally equivalent to <a href='SCA.html'>SCA</a>.</p>
    </div>

    <pre class="usage"><span class='fu'>SCA_RWM</span><span class='op'>(</span>
  x <span class='op'>=</span> <span class='fl'>1</span>,
  <span class='va'>Data</span>,
  AddInd <span class='op'>=</span> <span class='st'>"B"</span>,
  SR <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"BH"</span>, <span class='st'>"Ricker"</span><span class='op'>)</span>,
  vulnerability <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"logistic"</span>, <span class='st'>"dome"</span><span class='op'>)</span>,
  CAA_dist <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"multinomial"</span>, <span class='st'>"lognormal"</span><span class='op'>)</span>,
  CAA_multiplier <span class='op'>=</span> <span class='fl'>50</span>,
  rescale <span class='op'>=</span> <span class='st'>"mean1"</span>,
  max_age <span class='op'>=</span> <span class='va'>Data</span><span class='op'>@</span><span class='va'>MaxAge</span>,
  start <span class='op'>=</span> <span class='cn'>NULL</span>,
  fix_h <span class='op'>=</span> <span class='cn'>TRUE</span>,
  fix_F_equilibrium <span class='op'>=</span> <span class='cn'>TRUE</span>,
  fix_omega <span class='op'>=</span> <span class='cn'>TRUE</span>,
  fix_tau <span class='op'>=</span> <span class='cn'>TRUE</span>,
  LWT <span class='op'>=</span> <span class='cn'>NULL</span>,
  early_dev <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"comp_onegen"</span>, <span class='st'>"comp"</span>, <span class='st'>"all"</span><span class='op'>)</span>,
  late_dev <span class='op'>=</span> <span class='st'>"comp50"</span>,
  refyear <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>Data</span><span class='op'>@</span><span class='va'>Year</span><span class='op'>)</span><span class='op'>)</span>,
  M_bounds <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>2</span><span class='op'>)</span>,
  integrate <span class='op'>=</span> <span class='cn'>FALSE</span>,
  silent <span class='op'>=</span> <span class='cn'>TRUE</span>,
  opt_hess <span class='op'>=</span> <span class='cn'>FALSE</span>,
  n_restart <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>opt_hess</span>, <span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>,
  control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>iter.max <span class='op'>=</span> <span class='fl'>2e+05</span>, eval.max <span class='op'>=</span> <span class='fl'>4e+05</span><span class='op'>)</span>,
  inner.control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A position in the Data object (by default, equal to one for assessments).</p></td>
    </tr>
    <tr>
      <th>Data</th>
      <td><p>An object of class Data</p></td>
    </tr>
    <tr>
      <th>AddInd</th>
      <td><p>A vector of integers or character strings indicating the indices to be used in the model. Integers assign the index to
the corresponding index in Data@AddInd, "B" (or 0) represents total biomass in Data@Ind, "VB" represents vulnerable biomass in
Data@VInd, and "SSB" represents spawning stock biomass in Data@SpInd.</p></td>
    </tr>
    <tr>
      <th>SR</th>
      <td><p>Stock-recruit function (either <code>"BH"</code> for Beverton-Holt or <code>"Ricker"</code>).</p></td>
    </tr>
    <tr>
      <th>vulnerability</th>
      <td><p>Whether estimated vulnerability is <code>"logistic"</code> or <code>"dome"</code> (double-normal).
See details for parameterization.</p></td>
    </tr>
    <tr>
      <th>CAA_dist</th>
      <td><p>Whether a multinomial or lognormal distribution is used for likelihood of the catch-at-age matrix. See details.</p></td>
    </tr>
    <tr>
      <th>CAA_multiplier</th>
      <td><p>Numeric for data weighting of catch-at-age matrix if <code>CAA_hist = "multinomial"</code>. Otherwise ignored. See details.</p></td>
    </tr>
    <tr>
      <th>rescale</th>
      <td><p>A multiplicative factor that rescales the catch in the assessment model, which
can improve convergence. By default, <code>"mean1"</code> scales the catch so that time series mean is 1, otherwise a numeric.
Output is re-converted back to original units.</p></td>
    </tr>
    <tr>
      <th>max_age</th>
      <td><p>Integer, the maximum age (plus-group) in the model.</p></td>
    </tr>
    <tr>
      <th>start</th>
      <td><p>Optional list of starting values. Entries can be expressions that are evaluated in the function. See details.</p></td>
    </tr>
    <tr>
      <th>fix_h</th>
      <td><p>Logical, whether to fix steepness to value in <code>Data@steep</code> in the model for <code>SCA</code>. This only affects
calculation of reference points for <code>SCA2</code>.</p></td>
    </tr>
    <tr>
      <th>fix_F_equilibrium</th>
      <td><p>Logical, whether the equilibrium fishing mortality prior to the first year of the model
is estimated. If <code>TRUE</code>, <code>F_equilibrium</code> is fixed to value provided in <code>start</code> (if provided),
otherwise, equal to zero (assumes unfished conditions).</p></td>
    </tr>
    <tr>
      <th>fix_omega</th>
      <td><p>Logical, whether the standard deviation of the catch is fixed. If <code>TRUE</code>,
sigma is fixed to value provided in <code>start</code> (if provided), otherwise, value based on <code>Data@CV_Cat</code>.</p></td>
    </tr>
    <tr>
      <th>fix_tau</th>
      <td><p>Logical, the standard deviation of the recruitment deviations is fixed. If <code>TRUE</code>,
tau is fixed to value provided in <code>start</code> (if provided), otherwise, value based on <code>Data@sigmaR</code>.</p></td>
    </tr>
    <tr>
      <th>LWT</th>
      <td><p>A vector of likelihood weights for each survey.</p></td>
    </tr>
    <tr>
      <th>early_dev</th>
      <td><p>Numeric or character string describing the years for which recruitment deviations are estimated in <code>SCA</code>. By default,
equal to <code>"comp_onegen"</code>, where rec devs are estimated one full generation prior to the first year when catch-at-age (CAA) data are available.
With <code>"comp"</code>, rec devs are estimated starting in the first year with CAA. With <code>"all"</code>, rec devs start at the beginning of the model.
If numeric, the number of years after the first year of the model for which to start estimating rec devs. Use negative numbers for years prior to the first year.</p></td>
    </tr>
    <tr>
      <th>late_dev</th>
      <td><p>Typically, a numeric for the number of most recent years in which recruitment deviations will
not be estimated in <code>SCA</code> (recruitment in these years will be based on the mean predicted by stock-recruit relationship).
By default, <code>"comp50"</code> uses the number of ages (smaller than the mode)
for which the catch-at-age matrix has less than half the abundance than that at the mode.</p></td>
    </tr>
    <tr>
      <th>refyear</th>
      <td><p>An expression for the year for which M is used to report MSY and depletion reference points. By default, terminal year.</p></td>
    </tr>
    <tr>
      <th>M_bounds</th>
      <td><p>A numeric vector of length 2 to indicate the minimum and maximum M in the random walk as a proportion of the starting M
(M_start). The default min and max are 50% and 200%, respectively.</p></td>
    </tr>
    <tr>
      <th>integrate</th>
      <td><p>Logical, whether the likelihood of the model integrates over the likelihood
of the recruitment deviations and M random walk (thus, treating it as a random effects/state-space variable).
Otherwise, recruitment deviations and the random walk are penalized parameters.</p></td>
    </tr>
    <tr>
      <th>silent</th>
      <td><p>Logical, passed to <code><a href='https://rdrr.io/pkg/TMB/man/MakeADFun.html'>MakeADFun</a></code>, whether TMB
will print trace information during optimization. Used for diagnostics for model convergence.</p></td>
    </tr>
    <tr>
      <th>opt_hess</th>
      <td><p>Logical, whether the hessian function will be passed to <code><a href='https://rdrr.io/r/stats/nlminb.html'>nlminb</a></code> during optimization
(this generally reduces the number of iterations to convergence, but is memory and time intensive and does not guarantee an increase
in convergence rate). Ignored if <code>integrate = TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>n_restart</th>
      <td><p>The number of restarts (calls to <code><a href='https://rdrr.io/r/stats/nlminb.html'>nlminb</a></code>) in the optimization procedure, so long as the model
hasn't converged. The optimization continues from the parameters from the previous (re)start.</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>A named list of arguments for optimization to be passed to
<code><a href='https://rdrr.io/r/stats/nlminb.html'>nlminb</a></code>.</p></td>
    </tr>
    <tr>
      <th>inner.control</th>
      <td><p>A named list of arguments for optimization of the random effects, which
is passed on to <code><a href='https://rdrr.io/pkg/TMB/man/newton.html'>newton</a></code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other arguments to be passed.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <a href='Assessment-class.html'>Assessment</a>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The model estimates year-specific M (constant with age) as a random walk in logit space, bounded by
a proportion of <code>M_start</code> (specified in <code>M_bounds</code>).</p>
<p>The starting value for the first year M (M_start) is <code>Data@Mort[x]</code> and is fixed. 
The fixed SD of the random walk (<code>tau_M</code>) is 0.05.</p>
<p>Alternative values can be provided in the start list (see example).</p>
<p>See <a href='SCA.html'>SCA</a> for all other information about the structure and setup of the model.</p>
<p>The SCA builds in a stock-recruit relationship into the model. Annual unfished and MSY reference points are 
calculated and reported in TMB_report.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='SCA.html'>SCA</a></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Q. Huynh</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>SCA_RWM</span><span class='op'>(</span>Data <span class='op'>=</span> <span class='fu'>MSEtool</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/MSEtool/man/SimulatedData.html'>SimulatedData</a></span>, start <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>M_start <span class='op'>=</span> <span class='fl'>0.4</span>, tau_M <span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in if (obj$env$data$catch_eq == "Pope") {    dots &lt;- list(...)    dots$data$C_hist &lt;- rep(1e-08, dots$data$n_y)    par[names(par) == "U_equilibrium"] &lt;- 0    obj2 &lt;- MakeADFun(data = dots$data, parameters = dots$params,         map = dots$map, random = obj$env$random, DLL = "SAMtool",         silent = TRUE)    out &lt;- obj2$report(par)$E} else {    par[names(par) == "log_F_dev"] &lt;- log(1e-08)    par[names(par) == "F_equilibrium"] &lt;- 0    out &lt;- obj$report(par)$E}: argument is of length zero</span></div><div class='input'><span class='va'>res2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='SCA.html'>SCA</a></span><span class='op'>(</span>Data <span class='op'>=</span> <span class='fu'>MSEtool</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/MSEtool/man/SimulatedData.html'>SimulatedData</a></span><span class='op'>)</span>
<span class='va'>res3</span> <span class='op'>&lt;-</span> <span class='fu'>SCA_RWM</span><span class='op'>(</span>Data <span class='op'>=</span> <span class='fu'>MSEtool</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/MSEtool/man/SimulatedData.html'>SimulatedData</a></span>, start <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>M_start <span class='op'>=</span> <span class='fl'>0.4</span>, tau_M <span class='op'>=</span> <span class='fl'>0.001</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in if (obj$env$data$catch_eq == "Pope") {    dots &lt;- list(...)    dots$data$C_hist &lt;- rep(1e-08, dots$data$n_y)    par[names(par) == "U_equilibrium"] &lt;- 0    obj2 &lt;- MakeADFun(data = dots$data, parameters = dots$params,         map = dots$map, random = obj$env$random, DLL = "SAMtool",         silent = TRUE)    out &lt;- obj2$report(par)$E} else {    par[names(par) == "log_F_dev"] &lt;- log(1e-08)    par[names(par) == "F_equilibrium"] &lt;- 0    out &lt;- obj$report(par)$E}: argument is of length zero</span></div><div class='input'> 
<span class='co'># \donttest{</span>
<span class='fu'><a href='compare_models.html'>compare_models</a></span><span class='op'>(</span><span class='va'>res</span>, <span class='va'>res2</span>, <span class='va'>res3</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in compare_models(res, res2, res3): object 'res' not found</span></div><div class='input'><span class='co'># }</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Quang Huynh, Tom Carruthers, Adrian Hordyk.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


