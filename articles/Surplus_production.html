<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>1c. Surplus production model • SAMtool</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="1c. Surplus production model">
<meta property="og:description" content="SAMtool">
<meta property="og:image" content="https://SAMtool.openMSE.com/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SAMtool</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/SAMtool.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Delay_difference.html">1a. Delay-difference and delay-differential models</a>
    </li>
    <li>
      <a href="../articles/RCM.html">2. Description of the RCM (Rapid Conditioning Model) for conditioning MSEtool operating models</a>
    </li>
    <li>
      <a href="../articles/RCM_eq.html">2a. Mathematical description of the RCM</a>
    </li>
    <li>
      <a href="../articles/RCM_sel.html">2b. Configuring selectivity for the RCM</a>
    </li>
    <li>
      <a href="../articles/SCA.html">1b. Statistical catch-at-age (SCA) model</a>
    </li>
    <li>
      <a href="../articles/Surplus_production.html">1c. Surplus production model</a>
    </li>
    <li>
      <a href="../articles/VPA.html">1d. Virtual population analysis (VPA)</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Blue-Matter/SAMtool/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Surplus_production_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>1c. Surplus production model</h1>
                        <h4 class="author">Quang Huynh (<a href="mailto:quang@bluematterscience.com" class="email">quang@bluematterscience.com</a>)</h4>
            
            <h4 class="date">2021-03-31</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Blue-Matter/SAMtool/blob/master/vignettes/Surplus_production.Rmd"><code>vignettes/Surplus_production.Rmd</code></a></small>
      <div class="hidden name"><code>Surplus_production.Rmd</code></div>

    </div>

    
    
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "all"} } });
</script><style type="text/css">

body{ /* Normal  */
   font-size: 12px;
}
td {  /* Table  */
   font-size: 8px;
}
h1 { /* Header 1 */
 font-size: 18px;
 color: DarkBlue;
}
h2 { /* Header 2 */
 font-size: 15px;
 color: DarkBlue;
}
h3 { /* Header 3 */
 font-size: 14px;
 color: DarkBlue;
}
code.r{ /* Code block */
  font-size: 10px;
}
pre { /* Code block */
  font-size: 10px
}
</style>
<p><br></p>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>In SAMtool, assessment models are of class <code>Assess</code>. This appendix provides a brief description and references for the <code>Assess</code> objects. Further details regarding parameterization, e.g., fixing parameters, and tuning, e.g., adjusting start parameters, are provided in the function documentation.</p>
<p>For LaTeX equation rendering, it is recommended that this vignette be viewed in a HTML browser. This can be done with the <code>browseVignettes</code> function in R:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/browseVignettes.html">browseVignettes</a></span><span class="op">(</span><span class="st">"SAMtool"</span><span class="op">)</span></code></pre></div>
</div>
<div id="dynamics-equations" class="section level1">
<h1 class="hasAnchor">
<a href="#dynamics-equations" class="anchor"></a>Dynamics equations</h1>
<p>The surplus production model uses the Fletcher (1978) formulation. The biomass <span class="math inline">\(B_t\)</span> in year <span class="math inline">\(t\)</span> is <span class="math display">\[B_t = B_{t-1} + P_{t-1} - C_{t-1},\]</span> where <span class="math inline">\(C_t\)</span> is the observed catch and <span class="math inline">\(P_t\)</span> is the surplus production given by: <span class="math display">\[P_t = \gamma \times MSY \times \left(\dfrac{B_t}{K}-\left[\dfrac{B_t}{K}\right]^n\right), \]</span> where <span class="math inline">\(K\)</span> is the carrying capacity, <span class="math inline">\(MSY\)</span> is the estimated maximum sustainable yield, and <span class="math inline">\(n\)</span> is the parameter that controls shape of the production curve, and <span class="math inline">\(\gamma\)</span> is <span class="math display">\[\gamma = \dfrac{1}{n-1}n^{n/(n-1)}.\]</span></p>
<p>By conditioning the model on observed catch, the predicted index <span class="math inline">\(\hat{I}_t\)</span> is <span class="math display">\[\hat{I}_t = \hat{q} \hat{B}_t \]</span> and the harvest rate is <span class="math display">\[\hat{F}_t = \dfrac{C_t}{\hat{B}_t}.\]</span> The dynamics equations above use an annual time step. Optionally, smaller time steps are used in the model to approximate continuous production and fishing. Given the biomass in the start of the year and assuming a constant fishing mortality over the time steps within a year, the fishing mortality that produces the observed annual catch is solved iteratively.</p>
<p>The likelihood of the observed index <span class="math inline">\(I_t\)</span>, assuming a lognormal distribution, is <span class="math display">\[L = \sum_t \left(-\log(\sigma) - 0.5\left[\dfrac{\log(I_t) - \log(\hat{I}_t)}{\sigma}\right]^2\right).\]</span></p>
</div>
<div id="derived-parameters" class="section level1">
<h1 class="hasAnchor">
<a href="#derived-parameters" class="anchor"></a>Derived parameters</h1>
<p>From estimates of leading parameters <span class="math inline">\(F_{MSY}\)</span> and <span class="math inline">\(MSY\)</span>, the biomass <span class="math inline">\(B_{MSY}\)</span> at <span class="math inline">\(MSY\)</span> is <span class="math display">\[B_{MSY} = \dfrac{MSY}{F_{MSY}},\]</span> the carrying capacity <span class="math inline">\(K\)</span> is <span class="math display">\[K = n^{1/(n-1)} \times B_{MSY} ,\]</span> and the intrinsic rate of population increase <span class="math inline">\(r\)</span> is <span class="math display">\[ r = n \times F_{MSY}.\]</span> The production parameter <span class="math inline">\(n\)</span> is typically fixed and the model has a symmetric productive curve (<span class="math inline">\(B_{MSY}/K = 0.5\)</span>) when <span class="math inline">\(n = 2\)</span>.</p>
</div>
<div id="schaefer-model" class="section level1">
<h1 class="hasAnchor">
<a href="#schaefer-model" class="anchor"></a>Schaefer model</h1>
<p>The production parameter <span class="math inline">\(n\)</span> is typically fixed and the Schaefer model with a symmetric productive curve (<span class="math inline">\(B_{MSY}/K = 0.5\)</span>) is produced when <span class="math inline">\(n = 2\)</span>.</p>
</div>
<div id="fox-model" class="section level1">
<h1 class="hasAnchor">
<a href="#fox-model" class="anchor"></a>Fox model</h1>
<p>The Fox model is the limiting case of the Fletcher parameterization as <span class="math inline">\(n \rightarrow 1\)</span>, where</p>
<p><span class="math display">\[K = e \times B_{MSY}\]</span> <span class="math display">\[r = F_{MSY}\]</span> <span class="math display">\[P_t = -e \times MSY \times \dfrac{B_t}{K} \times \log\left(\dfrac{B_t}{K}\right) \]</span></p>
</div>
<div id="state-space-version-sp_ss" class="section level1">
<h1 class="hasAnchor">
<a href="#state-space-version-sp_ss" class="anchor"></a>State-space version (SP_SS)</h1>
<p>In the state-state version, annual biomass deviates are estimated as random effects. Similar to Meyer and Millar (1999), the biomass <span class="math inline">\(B_t\)</span> in year <span class="math inline">\(t\)</span> is <span class="math display">\[B_t = (B_{t-1} + P_{t-1} - C_{t-1})\exp(\delta_t - 0.5 \tau^2),\]</span> where <span class="math inline">\(\delta_t \sim N(0, \tau^2)\)</span> are biomass deviations in lognormal space and <span class="math inline">\(\tau\)</span> is the standard deviation of the biomass deviations.</p>
<p>Log-recruitment deviations <span class="math inline">\(\hat{\delta}_t\)</span> are typically estimated as penalized parameters towards the likelihood, with the penalty: <span class="math display">\[L^{\delta} = \sum_t \left(-\log(\tau) - 0.5\left[\dfrac{\delta_t}{\tau}\right]^2\right).\]</span></p>
</div>
<div id="prior-for-r" class="section level1">
<h1 class="hasAnchor">
<a href="#prior-for-r" class="anchor"></a>Prior for r</h1>
<p>To generate the prior for the intrinsic rate of increase, natural mortality <span class="math inline">\(M_a\)</span> and steepness <span class="math inline">\(h\)</span> are sampled from a distribution. Natural mortality is modelled to be age-invariant and is sampled from a lognormal distribution. Assuming either a Beverton-Holt or Ricker stock-recruit relationship, steepness is sampled from a transformed beta or transformed lognormal distribution, respectively.</p>
<p>For each pair of sampled M and h values, the corresponding value of <span class="math inline">\(r\)</span> is obtained by solving a modified Euler-Lotka equation: <span class="math display">\[\Sigma_{a=1}^A l_a m_a \exp(-r \times a) = 1.\]</span></p>
<p>Equation 15 is modified to include the <span class="math inline">\(\alpha\)</span> term from the stock-recruit relationship (Stanley et al. 2009). In this way, the recruits-per-spawner at low stock sizes, i.e., as spawning biomass approaches zero, is considered for calculating <span class="math inline">\(r\)</span>.</p>
<p>The numbers-per-recruit at age <span class="math inline">\(a\)</span> is <span class="math display">\[
l_a =
\begin{cases}
      1 &amp; a = 1\\
      l_{a-1} \exp(-M_{a-1}) &amp; a = 2, \ldots, A-1\\
      \dfrac{l_{a-1} \exp(-M_{a-1})}{1 - \exp(-M_a)} &amp; a = A \\
\end{cases}.
\]</span></p>
<p>Fecundity at age <span class="math inline">\(m_a\)</span> is <span class="math display">\[m_a = \dfrac{\alpha w_a}{\left[1 + \exp\left(-\log(19) \dfrac{a - \tilde{a}_{50}}{\tilde{a}_{95} - \tilde{a}_{50}}\right)\right]}, \]</span> where <span class="math inline">\(\tilde{a}_{50}\)</span> and <span class="math inline">\(\tilde{a}_{95}\)</span> are the ages of 50% and 95% maturity, respectively.</p>
<p>Weight-at-age <span class="math inline">\(w_a\)</span> is <span class="math display">\[w_a = W_{\infty}(1 - \exp[K\{a-a_0\}])^b.\]</span></p>
<p>The recruits per spawner at the origin of the stock-recruit relationship <span class="math inline">\(\alpha\)</span> is <span class="math display">\[\alpha = \dfrac{4h}{(1-h)\phi_0}, \]</span> or <span class="math display">\[\alpha = \dfrac{(5h)^{1.25}}{\phi_0},\]</span> for a Beverton-Holt and Ricker stock-recruit relationship, respectively, where unfished recruits-per-spawner <span class="math inline">\(\phi_0\)</span> is <span class="math display">\[\phi_0 = \Sigma_{a=1}^A l_a w_a m_a.\]</span></p>
<p>A normal distribution is assumed for the prior (a penalty to the likelihood) with the mean (<span class="math inline">\(\mu_r\)</span>) and standard deviation (<span class="math inline">\(\sigma_r\)</span>) calculated from the values of <span class="math inline">\(r\)</span> calculated using the above procedure:</p>
<p><span class="math display">\[L^r = - 0.5\left(\dfrac{\hat{r} - \mu_r}{\sigma_r}\right)^2,\]</span></p>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<p>Fletcher, R.I. 1978. On the restructuring of the Pella-Tomlinson system. Fishery Bulletin 76:515-521.</p>
<p>Meyer, R., and Millar, R.B. 1999. BUGS in Bayesian stock assessments. Canadian Journal of Fisheries and Aquatic Science 56:1078-1086.</p>
<p>Stanley, R.D., M. McAllister, P. Starr and N. Olsen. 2009. Stock assessment for bocaccio (Sebastes paucispinis) in British Columbia waters. DFO Can. Sci. Advis. Sec. Res. Doc. 2009/055. xiv + 200 p. </p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Quang Huynh, Tom Carruthers, Adrian Hordyk.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
